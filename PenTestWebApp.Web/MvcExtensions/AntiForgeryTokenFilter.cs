using System;
using System.Web.Helpers;
using System.Web.Mvc;

namespace PenTestWebApp.Web.MvcExtensions
{
    public class AntiForgeryTokenFilter : IAuthorizationFilter
    {
        private readonly AcceptVerbsAttribute _verbs;
        public AntiForgeryTokenFilter(HttpVerbs verbs)
        {
            _verbs = new AcceptVerbsAttribute(verbs);
        }
        public void OnAuthorization(AuthorizationContext filterContext)
        {
            if (_verbs.IsValidForRequest(filterContext, null))
            {
                AntiForgery.Validate();
            }   
        }
    }
}